# Gromit üêï

Ferramenta CLI para an√°lise de mudan√ßas git e gera√ß√£o de commits via IA.

## Funcionalidades

- ‚úÖ An√°lise de arquivos modificados no reposit√≥rio git
- ‚úÖ Visualiza√ß√£o de estat√≠sticas de mudan√ßas (inser√ß√µes/dele√ß√µes)
- ‚úÖ Preview das diferen√ßas (diff)
- ‚úÖ Gera√ß√£o de prompts para IA criar mensagens de commit
- ‚úÖ Integra√ß√£o com IA para gera√ß√£o autom√°tica de commits
- ‚úÖ Commit autom√°tico com mensagens geradas por IA
- ‚úÖ **Prote√ß√£o de branches principais** (master, main, develop)
- ‚úÖ **Revis√£o de commits pendentes** antes do push
- ‚úÖ **Preview de push** com valida√ß√£o pr√©via
- ‚úÖ Valida√ß√£o de boas pr√°ticas de desenvolvimento  
- ‚úÖ Suporte multil√≠ngue (pt-BR, es-UY, en-US)
- ‚úÖ Configura√ß√£o flex√≠vel de IA (URL, API Key, modelo)

## Instala√ß√£o

1. Clone o reposit√≥rio
2. Instale as depend√™ncias:
```bash
npm install
```

3. Compile o projeto:
```bash
npm run build
```

4. Para uso global, fa√ßa o link:
```bash
npm link
```

## Uso

### Desenvolvimento
```bash
npm run dev analyze
```

### Produ√ß√£o
```bash
# Ap√≥s fazer npm link
gromit analyze
```

## Configura√ß√£o Obrigat√≥ria

‚ö†Ô∏è **IMPORTANTE**: Os comandos `analyze --commit` e `commit` exigem configura√ß√£o pr√©via da IA.
üí° **INDEPENDENTES**: Os comandos `analyze --push`, `review` e `push` n√£o requerem configura√ß√£o e funcionam apenas com git.

Antes de usar o gromit, voc√™ deve configurar:
1. **URL da API da IA** (ex: OpenAI, Claude, etc.)
2. **Chave da API** (sua chave secreta)

```bash
# Configura√ß√£o completa
gromit config --url https://api.openai.com/v1/chat/completions --key sk-sua-chave

# Verificar configura√ß√£o
gromit config --show
```

## Comandos Dispon√≠veis

### `gromit analyze`
Analisa mudan√ßas no reposit√≥rio git para diferentes prop√≥sitos:

#### `gromit analyze --commit` (padr√£o)
‚ö†Ô∏è **Requer configura√ß√£o obrigat√≥ria** (URL da IA + API Key)

Analisa mudan√ßas locais para commit:
- Lista de arquivos modificados
- Quantidade de linhas alteradas por arquivo
- Resumo total das mudan√ßas
- Preview do diff das altera√ß√µes
- **Copia automaticamente** o prompt para o clipboard
- Gera prompt contextualizado para IA criar mensagem de commit

#### `gromit analyze --push`
üí° **N√£o requer configura√ß√£o** - funciona apenas com git

Gera prompt para IA criar t√≠tulo e descri√ß√£o do Pull Request:
- Analisa commits pendentes vs remote
- Inclui informa√ß√µes completas dos commits
- Lista arquivos modificados com estat√≠sticas
- **Inclui diff detalhado** para contexto da IA
- Usa template do projeto (CEN√ÅRIO, PROBLEMA, SOLU√á√ÉO)
- **Copia automaticamente** o prompt para o clipboard

```bash
# An√°lise para commit (comportamento padr√£o)
gromit analyze
gromit analyze --commit

# An√°lise com exibi√ß√£o do prompt na tela
gromit analyze --commit --show-prompt

# An√°lise para Pull Request
gromit analyze --push

# Exemplo de sa√≠da --commit:
# üìÅ ARQUIVOS MODIFICADOS:
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# üìÑ src/auth.ts
#    +25 -3 linhas alteradas
# üìã PROMPT COPIADO PARA O CLIPBOARD!
#
# Exemplo de sa√≠da --push:
# üìù PROMPT PARA PULL REQUEST GERADO!
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# üìä INFORMA√á√ïES ANALISADAS:
# üì¶ Commits pendentes: 3
# üìÇ Arquivos modificados: 5
# ‚úÖ Prompt copiado para o clipboard!
```

### `gromit commit`
‚ö†Ô∏è **Requer configura√ß√£o obrigat√≥ria** (URL da IA + API Key)

Funcionalidade completa de commit autom√°tico:
- **Valida branch protegida** - Impede commits em master, main ou develop
- Analisa as mudan√ßas no reposit√≥rio
- Gera prompt otimizado para IA
- Consulta a IA para criar mensagem de commit
- Exibe a mensagem gerada para aprova√ß√£o
- Adiciona arquivos ao stage (`git add .`)
- Faz o commit automaticamente

**üö´ Prote√ß√£o de Branches:**
- N√£o permite commits diretos em: `master`, `main`, `develop`
- Exibe mensagens informativas com sugest√µes de branches alternativas
- Garante boas pr√°ticas de desenvolvimento com feature branches

```bash
# Commit autom√°tico com IA
gromit commit

# O processo:
# 1. üîç Analisa mudan√ßas
# 2. ü§ñ Consulta IA 
# 3. üí¨ Mostra mensagem gerada
# 4. ‚è∏Ô∏è  Aguarda confirma√ß√£o (Enter)
# 5. ‚ûï Adiciona arquivos (git add .)
# 6. üìù Faz commit
```

### `gromit review`
Revisa commits locais pendentes antes do push para o reposit√≥rio remoto:
- Lista commits que ainda n√£o foram enviados ao remote
- Mostra resumo das mudan√ßas (arquivos, linhas inseridas/removidas)  
- Exibe arquivos modificados com √≠cones por tipo
- Op√ß√£o para preview das mudan√ßas (diff)
- Instru√ß√µes claras dos pr√≥ximos passos

**üîç Informa√ß√µes Exibidas:**
- **Commits pendentes**: Lista numerada com hash, mensagem, autor e data
- **Estat√≠sticas**: Quantidade de arquivos, linhas adicionadas/removidas
- **Arquivos modificados**: Lista com √≠cones espec√≠ficos por tipo de arquivo
- **Preview opcional**: Diff das mudan√ßas (limitado a 50 linhas)

**üìã Casos de Uso:**
- Revisar mudan√ßas antes do `git push`
- Verificar se h√° commits esquecidos localmente
- Validar altera√ß√µes antes de enviar para review
- Entender o impacto das mudan√ßas

```bash
# Revis√£o b√°sica dos commits pendentes
gromit review

# Revis√£o com preview das mudan√ßas
gromit review --show-diff

# Exemplo de sa√≠da:
# üìã COMMITS PENDENTES PARA PUSH (2):
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# 1. a1b2c3d feat(auth): adiciona autentica√ß√£o JWT
#    por Jo√£o Silva em 20/06/2025
# 2. d4e5f6g fix(ui): corrige layout responsivo
#    por Maria Santos em 20/06/2025
# 
# üìä RESUMO DAS MUDAN√áAS:
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# üìÇ Arquivos modificados: 5
# ‚ûï Linhas adicionadas: 127
# ‚ûñ Linhas removidas: 23
```

### `gromit push`
‚ö†Ô∏è **Requer configura√ß√£o obrigat√≥ria** (URL da IA + API Key)

**Comando completo de push com gera√ß√£o autom√°tica de Pull Request:**
- **Valida mudan√ßas n√£o commitadas** - Impede push se h√° arquivos pendentes de commit
- Lista commits que ser√£o enviados ao remote
- Mostra resumo detalhado das mudan√ßas
- **Gera t√≠tulo e descri√ß√£o via IA** usando template do projeto
- **Faz push autom√°tico** para o reposit√≥rio remoto
- **Cria URL de PR autom√°tica** (GitHub/GitLab)
- **Copia URL para clipboard** para cria√ß√£o instant√¢nea do PR

**üöÄ Processo Autom√°tico (5 etapas):**
1. **üìù Gera√ß√£o de prompt** - Cria contexto completo das mudan√ßas
2. **ü§ñ Consulta √† IA** - Gera t√≠tulo e descri√ß√£o personalizados
3. **üì§ Push autom√°tico** - Envia commits para o reposit√≥rio remoto
4. **üîó Gera√ß√£o de URL** - Cria link direto para PR (GitHub/GitLab)
5. **üìã C√≥pia para clipboard** - URL pronta para uso

**üîç Valida√ß√µes Realizadas:**
- **Mudan√ßas n√£o commitadas**: Detecta arquivos modificados que precisam de commit
- **Remote configurado**: Verifica se existe origin configurado
- **Commits pendentes**: Compara local vs remote para mostrar o que ser√° enviado
- **Configura√ß√£o da IA**: Valida URL e API Key antes de processar

**‚ú® Caracter√≠sticas:**
- **Processo ponta-a-ponta** - Do c√≥digo ao PR em um comando
- **IA integrada** - T√≠tulo e descri√ß√£o contextualizados
- **Multi-plataforma** - Suporte a GitHub e GitLab
- **Template personalizado** - Usa template do projeto (CEN√ÅRIO, PROBLEMA, SOLU√á√ÉO)
- **URL autom√°tica** - Link direto para criar PR no navegador

```bash
# Push completo com gera√ß√£o autom√°tica de PR
gromit push

# Push for√ßado (ignora mudan√ßas n√£o commitadas)
gromit push --force

# Push com visualiza√ß√£o detalhada do diff
gromit push --show-diff

# Combinar op√ß√µes
gromit push --force --show-diff

# Exemplo de sa√≠da:
# üöÄ INICIANDO PROCESSO AUTOM√ÅTICO:
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# 1. üìù Gerando prompt para IA...
# 2. ü§ñ Consultando IA para criar t√≠tulo e descri√ß√£o...
# ‚úÖ T√≠tulo e descri√ß√£o gerados!
# üìã T√≠tulo: feat(auth): implementa autentica√ß√£o JWT
# üìù Descri√ß√£o: #### Cen√°rio...
# 3. üì§ Fazendo push para o reposit√≥rio...
# ‚úÖ Push realizado com sucesso!
# 4. üîó Gerando URL autom√°tica do Pull Request...
# 
# üéâ PROCESSO CONCLU√çDO!
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# üì§ Commits enviados: 3
# üìÇ Arquivos modificados: 5
# üåê Remote: origin/master
# 
# üîó URL DO PULL REQUEST COPIADA PARA O CLIPBOARD!
# Cole a URL no navegador para criar o PR automaticamente:
# https://github.com/user/repo/compare/master...feature/auth?quick_pull=1&title=...
#
# Se a descri√ß√£o for muito longa (>800 caracteres):
# ‚ö†Ô∏è  DESCRI√á√ÉO TRUNCADA NA URL
# 1. Abra a URL no navegador (t√≠tulo e parte da descri√ß√£o preenchidos)
# 2. Cole a descri√ß√£o completa mostrada no terminal
#
# üí° Para apenas an√°lise: gromit analyze --push
```

### `gromit config`
Gerencia configura√ß√µes da IA (URL, chave da API, modelo e linguagem):
- `--url <url>` - Define a URL da API da IA
- `--key <key>` - Define a chave da API da IA
- `--model <model>` - Define o modelo da IA (ex: gpt-4-turbo, gpt-3.5-turbo)
- `--language <language>` - Define a linguagem dos commits (ex: pt-BR, en-US, es-UY)
- `--show` - Mostra as configura√ß√µes atuais
- `--reset` - Remove todas as configura√ß√µes

**Padr√µes:**
- **Modelo:** `gpt-4.1` (usado se n√£o configurado)
- **Linguagem:** `en-US` (ingl√™s americano - usado se n√£o configurado)

Exemplos:
```bash
# Configurar URL da IA
gromit config --url https://api.openai.com/v1/chat/completions

# Configurar chave da API
gromit config --key sk-sua-chave-da-api

# Configurar modelo espec√≠fico
gromit config --model gpt-4-turbo

# Configurar linguagem para portugu√™s brasileiro
gromit config --language pt-BR

# Configurar linguagem para espanhol uruguayo
gromit config --language es-UY

# Configurar tudo de uma vez
gromit config --url https://api.openai.com/v1/chat/completions --key sk-sua-chave --model gpt-4-turbo --language pt-BR

# Mostrar configura√ß√µes atuais
gromit config --show

# Resetar configura√ß√µes
gromit config --reset
```

## Estrutura do Projeto

```
src/
‚îú‚îÄ‚îÄ index.ts              # Entrada principal da CLI
‚îú‚îÄ‚îÄ commands/
‚îÇ   ‚îî‚îÄ‚îÄ analyze.ts        # Comando de an√°lise de mudan√ßas
‚îî‚îÄ‚îÄ utils/
    ‚îî‚îÄ‚îÄ promptGenerator.ts # Gerador de prompts para IA
```

## Desenvolvimento

- `npm run dev` - Executa em modo de desenvolvimento
- `npm run build` - Compila o projeto
- `npm run type-check` - Verifica tipos TypeScript

## Depend√™ncias

- **commander** - Framework para CLI
- **simple-git** - Interface para comandos git
- **chalk** - Coloriza√ß√£o de terminal
- **ora** - Spinners para feedback visual 